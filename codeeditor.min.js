var codeeditor={};codeeditor.instances=[],codeeditor.current=null,codeeditor.addEventListener=function(a,b,c){typeof a.addEventListener!="undefined"?a.addEventListener(b,c,!1):typeof a.attachEvent!="undefined"&&(a.detachEvent("on"+b,c),a.attachEvent("on"+b,c))},codeeditor.removeEventListener=function(a,b,c){typeof a.removeEventListener!="undefined"?a.removeEventListener(b,c,!1):typeof a.detachEvent!="undefined"&&a.detachEvent("on"+b,c)},codeeditor.fold=CodeMirror.newFoldFunction(CodeMirror.tagRangeFinder),codeeditor.getTextareasByClass=function(a){var b=document.getElementsByTagName("textarea"),c=new RegExp("(^|\\s)"+a+"(\\s|$)"),d=[],e,f;for(f=0,e=b.length;f<e;f++)textarea=b[f],c.test(textarea.className)&&d.push(textarea);return d},codeeditor.uniqueId=function(){var a="codeeditor",b;while(document.getElementById(a+b)!==null)b++;return a+b},codeeditor.fixMissingClass=function(){var a=document.getElementsByName("text"),b,c,d=null;for(b=0,c=a.length;b<c;b++)d=a[b],d.nodeName=="TEXTAREA"&&d.className==""&&(d.className="cmsimplecore_file_edit")},codeeditor.hasSubmit=function(a){var b,c,d,e;b=a.elements;for(d=0,c=b.length;d<c;d++){e=b[d];if(e.type=="submit")return!0}return!1},codeeditor.beforeUnload=function(a){var b,c;for(b=0,c=codeeditor.instances.length;b<c;b++)if(codeeditor.instances[b].historySize().undo>0)return a.returnValue=codeeditor.text.confirmLeave;return null},codeeditor.insertURI=function(a){var b=codeeditor.current;b.replaceSelection(a),b.focus()},codeeditor.instantiateByClasses=function(a,b,c){var d,e,f,g,h,i;for(e=0,d=a.length;e<d;e++){f=codeeditor.getTextareasByClass(a[e]);for(h=0,g=f.length;h<g;h++)i=f[e],i.id||(i.id=codeeditor.uniqueId()),codeeditor.instantiate(i.id,b,c)}},codeeditor.instantiate=function(a,b,c){var d=document.getElementById(a),e=d.offsetHeight,f=CodeMirror.fromTextArea(d,b);f.cmbMayPreview=c||!1,f.setSize(null,e),f.setOption("onFocus",function(a){codeeditor.current=a}),f.refresh(),codeeditor.instances.push(f),codeeditor.addEventListener(d.form,"submit",function(){CodeMirror.commands.save(f)}),codeeditor.addEventListener(window,"beforeunload",codeeditor.beforeUnload)},CodeMirror.commands.save=function(a){var b;codeeditor.removeEventListener(window,"beforeunload",codeeditor.beforeUnload),a.save(),b=a.getWrapperElement();while(b.nodeName!="FORM")b=b.parentNode;codeeditor.hasSubmit(b)||b.submit()},CodeMirror.commands.toggleFullscreen=function(a){var b=a.getScrollerElement(),c=document.body;b.className.indexOf("codeeditor_fullscreen")<0?(b.className+=" codeeditor_fullscreen",a.cmbOldOverflow=c.style.overflow,c.style.overflow="hidden"):(b.className=b.className.replace(/codeeditor_fullscreen/,""),c.style.overflow=a.cmbOldOverflow),a.refresh()},CodeMirror.commands.togglePreview=function(a){var b=a.getWrapperElement(),c;if(!a.cmbMayPreview)return;b.previousSibling&&b.previousSibling.className.indexOf("codeeditor_preview")>=0?(c=b.previousSibling,c.parentNode.removeChild(c),a.setOption("onBlur",null),a.cmbFullscreen&&(delete a.cmbFullscreen,CodeMirror.commands.toggleFullscreen(a))):(a.getScrollerElement().className.indexOf("codeeditor_fullscreen")>=0&&(CodeMirror.commands.toggleFullscreen(a),a.cmbFullscreen=!0),c=document.createElement("div"),c.className="codeeditor_preview",c.innerHTML=a.getValue(),b.parentNode.insertBefore(c,b),a.setOption("onBlur",function(){CodeMirror.commands.togglePreview(a)}))},CodeMirror.commands.toggleFolding=function(a){codeeditor.fold(a,a.getCursor().line)},CodeMirror.commands.toogleLineWrapping=function(a){a.setOption("lineWrapping",!a.getOption("lineWrapping"))},CodeMirror.commands.browseImages=function(a){typeof codeeditor.filebrowser=="function"&&codeeditor.filebrowser("images")},CodeMirror.commands.browseDownloads=function(a){typeof codeeditor.filebrowser=="function"&&codeeditor.filebrowser("downloads")},CodeMirror.commands.browseMedia=function(a){typeof codeeditor.filebrowser=="function"&&codeeditor.filebrowser("media")},CodeMirror.commands.browseUserfiles=function(a){typeof codeeditor.filebrowser=="function"&&codeeditor.filebrowser("userfiles")}